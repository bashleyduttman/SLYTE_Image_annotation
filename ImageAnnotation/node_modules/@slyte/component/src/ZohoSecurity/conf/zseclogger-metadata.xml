<?xml version="1.0" encoding="UTF-8"?>
<zseclogger>
	<eventsmetadata logservice="appsense" logtype="zsecevents">
		<commonfields>
			<field name="service" type="String" />
			<field name="timetaken" type="String" />
			<field name="data" type="JSONObject" />
		</commonfields>
		<events>
			<event name="app_register" category="connection">
				<metadata severity="success" data-template="message" />
				<metadata severity="connectionerror" data-template="exception" />
				<metadata severity="info" data-template="message" />
			</event>
			<event name="afw_rule_fetch" category="connection">
				<metadata severity="success" data-template="ruleFetch" />
				<metadata severity="error" data-template="exception" />
			</event>
			<event name="csp_logapi_status_fetch" category="connection">
				<metadata severity="success" data-template="message" />
				<metadata severity="error" data-template="exception" />
			</event>
			<event name="appsensenotification_status_fetch" category="connection">
				<metadata severity="success" data-template="message" />
				<metadata severity="error" data-template="exception" />
			</event>
			<event name="afw_rules_update" category="notification">
				<metadata severity="success" data-template="ruleUpdate" />
				<metadata severity="error" data-template="exception" />
			</event>
			<event name="csp_ro_status_update" category="notification">
				<metadata severity="success" data-template="message" />
				<metadata severity="error" data-template="exception" />
			</event>
			<event name="afw_rule_conversion" category="appfirewall">
				<metadata severity="success" data-template="ruleConvert" />
				<metadata severity="error" data-template="ruleConvert_err" />
			</event>
			<event name="afw_allowed_req" category="appfirewall">
				<metadata severity="success" data-template="ruleInfo" />
				<metadata severity="error" data-template="exception" />
			</event>
			<event name="afw_blocked_req" category="appfirewall">
				<metadata severity="critical" data-template="ruleMatch" />
			</event>
			<event name="sec_url_exception" category="secexception">
				<metadata severity="error" data-template="secException" />
			</event>
			<event name="sec_param_exception" category="secexception">
				<metadata severity="error" data-template="secParamException" />
			</event>
			<event name="sec_json_exception" category="secexception">
				<metadata severity="error" data-template="secJSONException" />
			</event>
			<event name="sec_conf_init" category="Initialization">
				<metadata severity="info" data-template="message" />
			</event>
			<event name="tls_error_redirection" category ="zdcm">
			     <metadata severity="success" data-template="tlsversion"/>
			</event>
			<event name="appsense_local_write" category="appfirewall_local">
			     <metadata severity="success" data-template="fileInfo" />
				 <metadata severity="error" data-template="exception" />
		    </event>
		    <event name="afw_rule_fetch_file" category="connection">
				<metadata severity="success" data-template="ruleFetch" />
				<metadata severity="error" data-template="exception" />
			</event>
			<event name="csp_logapi_status_fetch_file" category="connection">
				<metadata severity="success" data-template="message" />
				<metadata severity="error" data-template="exception" />
			</event>
			 <event name="performance_anomaly" category="anomaly">
				<metadata severity="critical" data-template="performance_data" />
			</event>
			<event name="security_xml_push" category="connection">
			 <metadata severity="error" data-template="message" />
			</event>
		</events>
		<datatemplates>
		    <datatemplate name="performance_data">
				<field name="module" type="String" />
				<field name="req_id" type="String" />
				<field name="metrics" type="String" />
			</datatemplate>
			<datatemplate name="exception">
				<field name="exception" type="String" />
				<field ref="message" />
			</datatemplate>
			<datatemplate name="message">
				<field name="message" type="String" />
			</datatemplate>
			<datatemplate name="ruleFetch">
				<field name="no_of_rules" type="String" />
				<field ref="message" />
			</datatemplate>
			<datatemplate name="ruleUpdate">
			     <field name="operation" type="String" />
				<field name="ruleIds" type="String" />				
			</datatemplate>
			<datatemplate name="ruleConvert">
				<field name="source_format" type="String" />
				<field ref="message" />
			</datatemplate>
			<datatemplate name="ruleConvert_err">
				<field name="source_format" type="String" />
				<field ref="exception" />
			</datatemplate>
			<datatemplate name="request">
				<field name="requesturi" type="String" />
				<field name="remoteaddress" type="String" />
			</datatemplate>
			<datatemplate name="ruleInfo">
				<field ref="request" />
				<field name="rule-info" type="JSONArray" />
			</datatemplate>
			<datatemplate name="ruleMatch">
				<field ref="ruleInfo" />
				<field name="rule-match" type="JSONObject" />
				<field name="rule-match-id" type="String" />
			</datatemplate>
			<datatemplate name="secException">
				<field ref="request,exception" />
			</datatemplate>
			<datatemplate name="secParam">
				<field name="param" type="String" />
				<field name="violated-param-conf" type="String" />
			</datatemplate>
			<datatemplate name="secParamException">
				<field ref="secException,secParam" />
				<field name="param-value" type="String" />
			</datatemplate>
			<datatemplate name="secJSONException">
				<field ref="secException,secParam" />
				<field name="key" type="String" />
				<field name="key-value" type="String" />
				<field name="violated-key-conf" type="String" />
			</datatemplate>
			<datatemplate name="tlsversion">
			    <field name="domain" type="String" />
				<field name="version" type="String" />
			</datatemplate>
			<datatemplate name="fileInfo">
				<field name="file-info" type="String" />
			</datatemplate>
		</datatemplates>
	</eventsmetadata>
	
	<exceptionmetadata logservice="appsense" logtype="zsecexception">
		<exceptions>
			<exception name="anomalous_exception" category="anomalous">
				<metadata severity="critical" data-template="exception" />
			</exception>
		</exceptions>
	<datatemplates>
	<datatemplate name="exception">
		<field name="error_code" type="String" />
		<field name="cause" type="String" />
		<field name="remote_ip" type="String" />
		<field name="status" type="String" />
		<field name="user_agent" type="String" />		
	</datatemplate>
	</datatemplates>
	</exceptionmetadata>
	
	<loggermetadata>
		<message name="appregister.success" class="com.zoho.security.server.agent.ServiceRegistration" method="register" level="info" />
		<message name="appregister.invalidstatuscode"   class="com.zoho.security.server.agent.ServiceRegistration" method="register" level="severe"/>
		<message name="appregister.exception" class="com.zoho.security.server.agent.ServiceRegistration" method="register" level="severe" />
		<message name="appregister.timertaskinfo" class="com.zoho.security.agent.ServiceRegistration.AppRegistrationTask" method="run" level="info"/>
		
		<message name="csplogapi.statusfetch.success" class="com.zoho.security.server.agent.ZSecAppSenseNotificationReceiver" level="severe" method="handleAgentNotification"/>
		<message name="csplogapi.statusfetch.startup.success" class="com.zoho.security.server.agent.ZSecAppSenseNotificationReceiver" level="severe" method="handleAppServerConfigurationsOnServerRestart"/>
		<message name="appsensenotification.statusfetch.servicemismatch" class="com.zoho.security.server.agent.ZSecAppSenseNotificationReceiver" method="handleAgentNotification" level="severe" />
		<message name="appsensenotification.statusfetch.exception" class="com.zoho.security.server.agent.ZSecAppSenseNotificationReceiver" method="handleAgentNotification" level="severe" />
		<message name="csplogapi.statusfetch.exception" class="com.zoho.security.server.agent.ZSecAppSenseNotificationReceiver" level="severe" method="handleAgentNotification"/>
		<message name="csplogapi.statusfetch.startup.exception" class="com.zoho.security.server.agent.ZSecAppSenseNotificationReceiver" level="severe" method="handleAppServerConfigurationsOnServerRestart"/>
		<message name="csplogapi.statusfetch.invalidstatuscode" class="com.zoho.security.server.agent.ZSecAppSenseNotificationReceiver" level="severe" method="getConfigurationStatus"/>
		
		<message name="afwrule.conversion.invalidoperator" class="com.zoho.security.appfirewall.DirectiveConfiguration" method="DirectiveConfiguration" level="info"/>
		<message name="afwrule.conversion.invalidcomponent" class="com.zoho.security.appfirewall.DirectiveConfiguration"  method="DirectiveConfiguration" level="info" />
		<message name="afwrule.conversion.invaliddirective" class="com.zoho.security.appfirewall.DirectiveConfiguration"  method="DirectiveConfiguration" level="info"/>
	
		<message name="afwrulefetch.success" class="com.zoho.security.appfirewall.AppFirewallPolicyLoader" level="severe" method="loadAppFirewallPolicyFromAppSense" />
		<message name="afwrulefetch.invalidstatuscode" class="com.zoho.security.appfirewall.AppFirewallPolicyLoader" level="severe" method="loadAppFirewallPolicyFromAppSense"/>
		<message name="afwrulefetch.invalidstructure" class="com.zoho.security.appfirewall.AppFirewallPolicyLoader" level="severe" method="loadAppFirewallPolicyFromAppSense" />
		<message name="afwrulefetch.exception" class="com.zoho.security.appfirewall.AppFirewallPolicyLoader" level="severe" method="loadAppFirewallPolicyFromAppSense" />
		<message name="afwrulefetch.xml.invalidstructure" class="com.zoho.security.appfirewall.AppFirewallPolicyLoader" level="severe" method="loadAppFireWallPolicyFromFile" />
		<message name="afwrulefetch.xml.exception" class="com.zoho.security.appfirewall.AppFirewallPolicyLoader" level="severe" method="loadAppFireWallPolicyFromFile" />
		<message name="afwrulefetch.xml.schemavalidationexception" class="com.zoho.security.appfirewall.AppFirewallPolicyLoader" level="severe" method="loadFirewallRules" />
		<message name="afwrulefetch.xml.success" class="com.zoho.security.appfirewall.AppFirewallPolicyLoader" level="severe" method="loadFirewallRules"/>
		<message name="afwrulefetch.xml.loadfailure" class="com.zoho.security.appfirewall.AppFirewallPolicyLoader" level="severe" method="loadFirewallRules" />
		<message name="afwrulefetch.xml.empty" class="com.zoho.security.appfirewall.AppFirewallPolicyLoader" level="severe" method="loadFirewallRules" />
		<message name="afwrulefetch.iam.exception" class="com.zoho.security.appfirewall.AppFirewallPolicyLoader" level="severe" method="loadAppFirewallPolicyFromIAM" />
		<message name="afwrule.conversion.invalidsyntax" class="com.zoho.security.appfirewall.DirectiveConverter" level="severe" method="extractRulesFromElement" />
		<message name="afwrule.conversion.emptycomponent" class="com.zoho.security.appfirewall.DirectiveConfiguration" level="info" method="DirectiveConfiguration" />
		<message name="afwallowedreq.exception" class="com.zoho.security.appfirewall.AppFirewallScanner" level="severe" method="multiStageFirewall" />
		<message name="afwallowedreq.rulematchinfo" class="com.zoho.security.appfirewall.AppFirewallScanner" level="severe" method="requestFirewallRegulator" />
	    <message name="afwrule.update.exception" class="com.zoho.security.server.agent.ZSecAppSenseNotificationReceiver" level="severe" method="handleAgentNotification"/>
	    <message name="afwrule.update.success" class="com.zoho.security.server.agent.ZSecAppSenseNotificationReceiver" level="severe" method="handleAgentNotification"/>
	   
	   <message name="tls.error.redirection.success" class="com.zoho.security.util.SASConfigProvider" level="warning" method="checkForTLSErrorRedirection"/>
	    <message name="mkdir.appsense" class="AppFirewallFileStore" level="info" method ="save"/>
	   <message name="io.exception" class="AppFirewallFileStore" level="severe" method ="save"/>
	   <message name="appsense.local.write" class="AppFirewallFileStore" level="info" method ="save"/>
	   <message name="performance.anomaly" class="SecurityFilter" level="severe" method="doFilter"/>
	   <message name="config.push.exception" class="com.zoho.security.agent.LocalConfigurations" level="severe" method="initAppRegisterOnModifiedConfigurations"/>
	   <message name="config.push.success" class="com.zoho.security.agent.LocalConfigurations" level="severe" method="initAppRegisterOnModifiedConfigurations"/>
	   
	</loggermetadata>
</zseclogger>
