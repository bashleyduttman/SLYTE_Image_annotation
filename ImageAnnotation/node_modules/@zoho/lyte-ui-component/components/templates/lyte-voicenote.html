<template tag-name="lyte-voicenote">
  <template lyte-if="{{renderPrefetch}}">
    <div class="lyteVoiceNotePrefetchContainer">
      <div class="lyteVoiceNotePrefetchPlayIcon" onclick="{{action('prefetch')}}">
        <div class="lyteCircleLoader">
          <span class="lyteCircleInnerLoader"></span>
        </div>
      </div>
      <div class="lyteVoiceNotePrefetchLoadBarWrap">
        <template lyte-if="{{ltPropLoadingMessage}}">
          <span class="lyteVoiceNotePrefetchMessage">{{ltPropLoadingMessage}}</span>
        </template>

        <span class="lyteVoiceNotePrefetchLoadingBar"></span>
      </div>
    </div>
  </template>
  <template lyte-else>
    <span class="lyteVoiceNotePausePlayIcon {{state}}" onclick="{{action('toggle')}}"></span>
    <audio onpause="{{action('pause')}}" onplay="{{action('play')}}" onvolumechange="{{action('changeVolume', event)}}" onloadedmetadata="{{action('meta', event)}}" ontimeupdate="{{action('update',event)}}" preload="{{ltPropPreload}}" onprogress="{{action('progress',this)}}">
      <template lyte-for="{{ltPropSrc}} as item index ">
        <source onerror="{{action('error',event)}}" src={{item.src}} type='{{item.type||"audio/mpeg"}}' label={{item.label}}>
      </template>

    </audio>
    <div class="lyteVoiceNoteProgress" tabindex="0" onkeydown="{{action('keydown',event)}}" onclick="{{action('progressClick', event)}}">
      <span class="lyteVoiceNoteCompletion"></span>
      <span class="lyteVoiceNotePreload" style="{{progressLoad}}"></span>
      <span class="lyteVoiceNoteHandler" lt-prop-tooltip-class = "lyteVoiceNoteTooltip" onmousedown="{{action('mousedown', event)}}" lt-prop-title = {{elapsedTime}} lt-prop-tooltip-config = '{"showdelay":500,"hidedelay" : 500, "position" : "bottom"}'></span>
    </div>
  </template>

  <time class="lyteVoiceNoteElapsedTime" datetime={{elapsedFormat}}>{{elapsedTime}}</time>
  <span  class="lyteVoiceNoteTimeSeparate" lyte-if="{{elapsedTime}}">/</span>
  <time class="lyteVoiceNoteDurationSpan" datetime={{datetimeFormat}}>{{duration}}</time>
  <template lyte-if="{{ltPropVolumeControl}}">
    <div class="lyteVoiceNoteVolumeController">
      <span class="lyteVoiceNoteVolumeControl {{randomClass}}{{if(muted,' lyteVoiceNoteMuteIcon','')}}{{fullVolume}}" onclick="{{action('togglePop')}}"></span>
      <lyte-popover lt-prop-scrollable="true" lt-prop={{ltPropPopover}} lt-prop-show={{lbind(popShow)}} lt-prop-origin-elem=".{{randomClass}}" lt-prop-content-padding="">
        <template is="registerYield" yield-name="popover">
          <lyte-popover-content class="lyteVoiceNotePopover">
            <div class="lyteVoiceNoteVolumeSlider">
              <span class="lyteVoiceNoteVolumeIcon{{if(muted,' lyteVoiceNoteMuteIcon','')}}{{fullVolume}}" onclick="{{action('onMute')}}"></span>
              <lyte-multislider lt-prop-max='1' lt-prop-fill-color='#ddd' lt-prop-height='2px' lt-prop-yield=true lt-prop-width='60px' lt-prop-handler='lyteCircle' lt-prop-value='[ { "value" : {{ltPropVolume}}, "min" : 0, "max" : 1 } ]' on-change="{{method('setVolume')}}" lt-prop-color='["#61A6E8" ]'></lyte-multislider>
            </div>
          </lyte-popover-content>
        </template>
      </lyte-popover>
    </div>
  </template>
  <template lyte-if="{{ltPropPlaybackRate}}">
    <lyte-dropdown class="lyteVoiceNotePlaybackRate" lt-prop-selected={{lbind(ltPropPlaybackRate)}}>
      <template is="registerYield" yield-name="yield">
        <lyte-drop-box class="lyteVoiceNotePlaybackRateDropbox">
          <lyte-drop-body>
            <template lyte-for="{{ltPropPlaybackOptions}} as item index ">
              <lyte-drop-item data-value={{item.value}}>{{item.label}}</lyte-drop-item>
            </template>

          </lyte-drop-body>
        </lyte-drop-box>
      </template>
    </lyte-dropdown>
  </template>

</template>