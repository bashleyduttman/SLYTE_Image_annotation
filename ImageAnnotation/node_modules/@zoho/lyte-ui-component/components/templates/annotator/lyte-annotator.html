<template tag-name="lyte-annotator">
  <template lyte-if="{{render}}">
    <lyte-wormhole class="lyteAnnotatorWormhole" on-before-append="{{method('beforeappend')}}">
      <template is="registerYield" yield-name="lyte-content">
        <div class="lyteAnnotatorOuterWrapper {{ltPropWrapperClass}} {{loading}}">
          <lyte-annotator-wrapper>
            <lyte-annotator-header>
              <template lyte-if="{{ltPropHeaderYield}}">
                <lyte-yield yield-name="annotator-header"></lyte-yield>
              </template>
              <template lyte-else><template lyte-for="{{ltPropButtons}} as item index ">
                  <lyte-button lt-prop="{{stringify(item.properties)}}" class="lyteAnnotatorButton lyteAnnotator{{item.purpose}}" onclick="{{action('buttonclick',item.purpose)}}">
                    <template is="registerYield" yield-name="text">
                      {{item.text}}
                    </template>
                  </lyte-button>
                </template>
              </template>

            </lyte-annotator-header>
            <lyte-annotator-content onmousedown="{{action('mousedown',event)}}" ontouchstart="{{action('mousedown',event)}}" tabindex=0 onkeydown="{{action('keydown',event,this)}}">
              <lyte-annotator-whiteboard-content>
                <lyte-whiteboard-area>
                  <template lyte-if="{{isImage}}">
                    <canvas ref_x=0 ref_y=0 class="lyteAnnotatorCanvas"></canvas>
                  </template>

                  <svg xmlns="http://www.w3.org/2000/svg" class="lyteAnnotatorSvg" viewBox={{viewBox}}>
                  </svg>
                  <template lyte-if="{{renderCrop}}">
                    <lyte-crop-wrapper>
                      <lyte-crop-left></lyte-crop-left>
                      <lyte-crop-top></lyte-crop-top>
                      <lyte-crop-bottom></lyte-crop-bottom>
                      <lyte-crop-right></lyte-crop-right>
                      <lyte-crop-content></lyte-crop-content>
                    </lyte-crop-wrapper>
                  </template>
                  <template lyte-if="{{loading}}">
                    <lyte-annotator-loading class={{loading}}></lyte-annotator-loading>
                  </template>
                  <template lyte-if="{{ltPropSmartGuide}}">
                    <div class="lyteAnnotatorSmartGuides lyteConnectHorizontal lyteAnnotatorHidden"></div>
                    <div class="lyteAnnotatorSmartGuides lyteConnectVertical lyteAnnotatorHidden"></div>
                  </template>

                </lyte-whiteboard-area>
              </lyte-annotator-whiteboard-content>
            </lyte-annotator-content>
            <template lyte-if="{{ltPropZoom && isImage}}">
              <lyte-annotator-footer>
                <div class="lyteAnnotatorZoom">
                  <div class="lyteAnnotatorZoomPrev {{disablePrev}}" onclick="{{action('prevZoom')}}">-</div>
                  <lyte-dropdown lt-prop-display-value={{lbind(displayValue)}} lt-prop-selected="{{lbind(ltPropZoomLevel)}}">
                    <template is="registerYield" yield-name="yield">
                      <lyte-drop-box class="lyteAnnotatorZoomDropdown">
                        <lyte-drop-body>
                          <template lyte-for-in="{{ltPropZoomOptions}} as value key ">
                            <lyte-drop-item data-value={{key}} class="lyteAnnotatorZoom_{{key}}">{{value}}</lyte-drop-item>
                          </template>

                        </lyte-drop-body>
                      </lyte-drop-box>
                    </template>
                  </lyte-dropdown>
                  <div class="lyteAnnotatorZoomNext {{disableNext}}" onclick="{{action('nextZoom')}}">+</div>
                </div>
              </lyte-annotator-footer>
            </template>
            <template lyte-if="{{ltPropContextMenu && renderMenu}}">
              <lyte-menu lt-prop-show={{lbind(menuShow)}} lt-prop-event="contextmenu" lt-prop-query='lyte-annotator-wrapper' lt-prop-yield=true lt-prop-wrapper-class="lyteAnnotatorMenu" on-before-open="{{method('beforeMenu')}}" on-menu-click="{{method('menuSelect')}}">
                <template is="registerYield" yield-name="yield">
                  <lyte-menu-body>
                    <template lyte-for-in="{{ltPropContextMenuOptions}} as value key ">
                      <lyte-menu-item lt-prop-disabled={{value.disabled}} class="lyteAnnotatorMenu_{{key}} {{value.show}}" data-value={{key}}>{{value.value}}</lyte-menu-item>
                    </template>

                  </lyte-menu-body>
                </template>
              </lyte-menu>
            </template>

          </lyte-annotator-wrapper>
          <template lyte-if="{{ltPropSidePanelData}}">
            <lyte-annotator-sidepanel class="lyteAnnotatorSidePanel_{{ltPropPanelDirection}}" tabindex=0 onkeydown="{{action('side_nav',event)}}">
              <lyte-sidepanel-resize-handler ontouchstart="{{action('move',event)}}" onmousedown="{{action('move',event)}}">...</lyte-sidepanel-resize-handler>
              <template lyte-for="{{ltPropSidePanelData}} as item index ">
                <div class="{{lyteAnnotator(item,item.active,item.direction)}}" onclick="{{action('side_click',item)}}">
                  <span class="lyteAnnotatorLabel">{{item.value}}</span>
                  <template lyte-if="{{item.children}}">
                    <div class="lyteAnnotatorChildWrapper {{item.open}}">
                      <template lyte-for="{{item.children}} as inner inn_index ">
                        <div class="{{lyteAnnotator(inner,inner.active)}}" onclick="{{action('side_click',inner,item)}}">
                          <span class="lyteAnnotatorLabel">{{inner.value}}</span>
                        </div>
                      </template>

                    </div>
                  </template>

                </div>
              </template>

            </lyte-annotator-sidepanel>
          </template>
          <template lyte-if="{{ltPropEditorPanel && renderFilter}}">
            <lyte-annotator-editorpanel class={{showFilter}}>
              <lyte-editor-resize-handler ontouchstart="{{action('move',event)}}" onmousedown="{{action('move',event)}}">...</lyte-editor-resize-handler>
              <template lyte-if="{{renderFill}}">
                <lyte-annotator-item pk=true type="fill" class='lyteAnnotatorFill {{showFill}}' lt-prop-item={{ltPropEditorPanelData.fill}} show={{lbind(openFillPop)}} onclick="{{action('openPop','Fill')}}" on-apply='{{method("applyFill")}}'></lyte-annotator-item>
              </template>
              <template lyte-if="{{renderStroke}}">
                <lyte-annotator-item pk=true type="stroke" class='lyteAnnotatorStroke {{showStroke}}' lt-prop-item={{ltPropEditorPanelData.stroke}} show={{lbind(openStrokePop)}} onclick="{{action('openPop','Stroke')}}" on-apply='{{method("applyStroke")}}'></lyte-annotator-item>
              </template>
              <template lyte-if="{{renderBorder}}">
                <lyte-annotator-item pk=true type="border" class='lyteAnnotatorBorder {{showBorder}}' lt-prop-item={{ltPropEditorPanelData.border}} show={{lbind(openBorderPop)}} onclick="{{action('openPop','Border')}}" on-apply='{{method("applyBorder")}}'></lyte-annotator-item>
              </template>
              <template lyte-if="{{renderFont}}">
                <lyte-annotator-item pk=true type="font" class='lyteAnnotatorFont {{showFont}}' lt-prop-item={{ltPropEditorPanelData.font}} show={{lbind(openFontPop)}} onclick="{{action('openPop','Font')}}" on-apply='{{method("applyFont")}}'></lyte-annotator-item>
              </template>
              <template lyte-if="{{renderColor}}">
                <lyte-annotator-item pk=true type="color" class='lyteAnnotatorColor {{showColor}}' lt-prop-item={{ltPropEditorPanelData.color}} show={{lbind(openColorPop)}} onclick="{{action('openPop','Color')}}" on-apply='{{method("applyColor")}}'></lyte-annotator-item>
              </template>
              <template lyte-if="{{renderOutline}}">
                <lyte-annotator-item pk=true type="outline" class='lyteAnnotatorOutlet {{showOutline}}' lt-prop-item={{ltPropEditorPanelData.outline}} onclick="{{action('toggleOutline',this)}}"></lyte-annotator-item>
              </template>
              <template lyte-if="{{renderDashed}}">
                <lyte-annotator-item pk=true type="dashed" class='lyteAnnotatorDashed {{showDashed}}' lt-prop-item={{ltPropEditorPanelData.dashed}} show={{lbind(openDashedPop)}} onclick="{{action('openPop','Dashed')}}" on-apply='{{method("applyDashed")}}'></lyte-annotator-item>
              </template>

            </lyte-annotator-editorpanel>
          </template>

        </div>
      </template>
    </lyte-wormhole>
  </template>

</template>