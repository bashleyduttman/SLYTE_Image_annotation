<template tag-name="lyte-video">
  <div tabindex="0" class="lyteVideoContainer lyteVideoControlsShow" onpointerenter="{{action('mouseEnter',event, this )}}" onpointerleave="{{action('mouseLeave', this)}}" onpointermove="{{action('mouseMove',event, this )}}" onkeydown="{{action('keyDown', event)}}">
    <div class="lyteVideoAnimateWrapper lyteVideoAnimateBackward">
      <span class="lyteVideoAnimateBackArrow lyteVideoAnimateArrow3"></span>
      <span class="lyteVideoAnimateBackArrow lyteVideoAnimateArrow2"></span>
      <span class="lyteVideoAnimateBackArrow lyteVideoAnimateArrow1"></span>
    </div>
    <div class="lyteVideoAnimateWrapper lyteVideoAnimatePlay">
      <span class="lyteVideoAnimatePauseIcon"></span>
    </div>
    <div class="lyteVideoAnimateWrapper lyteVideoAnimateForward">
      <span class="lyteVideoAnimateForwardArrow lyteVideoAnimateArrow1"></span>
      <span class="lyteVideoAnimateForwardArrow lyteVideoAnimateArrow2"></span>
      <span class="lyteVideoAnimateForwardArrow lyteVideoAnimateArrow3"></span>
    </div>
    <template lyte-if="{{(renderPrefetch && prefetchLoading == &quot;lyteVideoPrefetchLoading&quot;) || ( !renderPrefetch && !canPlay )}}">
      <div class="lyteVideoPrefetchLoadingContainer">
        <div class="lyteCircleLoader">
          <span class="lyteCircleInnerLoader"></span>
        </div>
      </div>
    </template>

    <canvas class="lyteVideoPoster {{if(hidePoster, 'lyteVideoPosterHide')}} {{if(renderPrefetch, 'lyteVideoPosterBeforeVideoLoad')}}" onclick="{{action('clickOnVideo')}}"></canvas>
    <template lyte-if="{{renderPrefetch}}">

      <div class="lyteVideoControls hoverControls lyteVideoPrefetchControlsContainer">
        <div class="lyteVideoProgressWrapper">
          <div class="lyteVideoProgressBar">
            <span class="lyteVideoProgressHandler" style="left: 0;"></span>
          </div>
          <div class="lyteVideoTimer">
            <time class="duration">{{currentDuration}}</time>
            <span class="lyteVideoTimerSeparator">/</span>
            <time>{{duration}}</time>
          </div>
        </div>

        <div class="lyteVideoIconsWrap">
          <div lyte-if="{{ltPropOptions.play != false}}" class="lyteVideoPlayPauseIconWrap">
            <span class="lyteVideoIcons lyteVideoPlayIcon lyteVideoPaused" lt-prop-title="{{videoStatus}}" onclick="{{action('prefetch',this)}}"></span>
          </div>
          <div lyte-if="{{ltPropOptions.backward != false}}" class="lyteVideoRewind">
            <span class="lyteVideoIcons lyteVideoRewindIcon" lt-prop-title="Play the video to enable controls"></span>
          </div>
          <div lyte-if="{{ltPropOptions.forward != false}}" class="lyteVideoForward">
            <span class="lyteVideoIcons lyteVideoForwardIcon" lt-prop-title="Play the video to enable controls"></span>
          </div>
          <div lyte-if="{{ltPropOptions.volume != false}}" class="lyteVideoVolumeControls">
            <span class="lyteVideoVolumeIcon" lt-prop-title="{{volumeStatus}}" onclick="{{action('mute',this)}}"></span>
            <div class="lyteVideoVolumeSlider">
              <lyte-multislider lt-prop-css-direction="ltr" lt-prop-max='1' lt-prop-yield=true lt-prop-handler='lyteCircle' lt-prop-value='[ { "value" : {{volume}}, "min" : 0, "max" : 1 } ]' on-change="{{method('setVolume')}}"></lyte-multislider>
            </div>
          </div>
          <div class="lyteVideoRightIcons">
            <div lyte-if="{{ltPropOptions.settings != false}}" class="lyteVideoSettings">
              <span class="lyteVideoIcons lyteVideoSettingsIcon" lt-prop-title="Play the video to enable controls" ></span>
            </div>
            <template lyte-if="{{isNotFirefox}}">
              <div lyte-if="{{ltPropOptions.pip != false}}" class="lyteVideoPip">
                <span class="lyteVideoIcons lyteVideoPipIcon" lt-prop-title="Play the video to enable controls" ></span>
              </div>
            </template>

            <div lyte-if="{{ltPropOptions.fullScreen != false}}" class="lyteVideoFullScreenControl">
              <span class="lyteVideoIcons lyteVideoFullScreen" lt-prop-title="Play the video to enable controls"></span>
            </div>
          </div>

        </div>
      </div>
    </template>
    <template lyte-else>
      <template lyte-if="{{ltPropMiniMode}}">
        <lyte-pip lt-prop-pip-mode="{{miniMode}}" lt-prop-use-browser-api="false" lt-prop-resize="{{miniModeOptions.resize}}" lt-prop-draggable="{{miniModeOptions.draggable}}" lt-prop-resize-max-width="{{miniModeOptions.resizeMaxWidth}}" lt-prop-resize-min-width="{{miniModeOptions.resizeMinWidth}}" lt-prop-resize-max-height="{{miniModeOptions.resizeMaxHeight}}" lt-prop-resize-min-height="{{miniModeOptions.resizeMinHeight}}" lt-prop-header-yield="{{miniModeOptions.headerYield}}" lt-prop-footer-yield="{{miniModeOptions.footerYield}}" lt-prop-pip-window-width="{{miniModeOptions.miniWindowWidth}}" lt-prop-pip-window-height="{{miniModeOptions.miniWindowHeight}}">
          <template is="registerYield" yield-name="header">
            <lyte-yield yield-name="header"></lyte-yield>
          </template>
          <template is="registerYield" yield-name="video">
            <div class="lyteVideoMiniContainer" onpointerenter="{{action('mouseEnter',event, this )}}" onpointerleave="{{action('mouseLeave', event, this )}}" onpointermove="{{action('mouseMove',event, this )}}">
              <div class="lytePipFullScreenIconContainer" onclick="{{action('toggleMiniMode')}}">
                <div class="lytePipFullScreenIcon"></div>
              </div>
              <div class="lytePipCloseIconContainer" onclick="{{action('toggleMiniMode', true )}}">
                <div class="lytePipCloseIcon"></div>
              </div>
            </div>
          </template>
          <template is="registerYield" yield-name="footer">
            <lyte-yield yield-name="footer"></lyte-yield>
          </template>
        </lyte-pip>
      </template>

      <video class="lyteVideo" onvolumechange="{{action('changeVolume',event)}}" preload="{{ltPropPreLoad}}" crossorigin="{{ltPropCrossOrigin}}" ontimeupdate="{{action('update',event)}}" onloadeddata="{{action('progress', event)}}" onprogress="{{action('progress', event )}}" onloadedmetadata="{{action('meta', event)}}" onpause="{{action('pause', event )}}" onplay="{{action('play', event )}}" onclick="{{action('clickOnVideo')}}" ondblclick="{{action('toggleFullScreen')}}" oncanplay="{{action('onCanPlay')}}" onwaiting="{{action('onWaiting', false)}}" onplaying="{{action('onWaiting', true)}}">
        <source src="{{ltPropSource[0].src}}" type="{{ltPropSource[0].type}}" label="{{ltPropSource[0].label}}" size="{{ltPropSource[0].size}}">
        <template lyte-if="{{ltPropTracks}}">
          <track>
        </template>

      </video>
      <template lyte-if="{{subtitles}}">
        <div class="lyteVideoSubtitleWrapper">
          <p class="lyteVideoSubtitle">{{subText}}</p>
        </div>
      </template>

      <div class="lyteVideoControls hoverControls">
        <div class="lyteVideoProgressWrapper">
          <div class="lyteVideoProgressBar" onclick="{{action('progressClick',event)}}" onmousemove="{{action('updateToolTip',event)}}">
            <div class="lyteVideoToolTip" lyte-if="{{!miniMode}}">
              <div>
                <p class="lyteVideoTooltipChapterName">{{toolTip.name}}</p>
                <p class="lyteVideoTooltipCurrentTime">{{toolTip.time}}</p>
              </div>
            </div>
            <template lyte-if="{{chaptersData}}">
              <div class="lyteVideoChapterWrapper">
                <template lyte-for="{{chaptersData}} as item index ">
                  <div class="lyteVideoChapter" data-start="{{item.startTime}}" data-end="{{item.endTime}}" data-label="{{item.title}}" style="width: {{item.width}}%;">
                    <span class="lyteVideoProgressed" style="width: {{item.time}}%;" ></span>
                    <span class="lyteVideoProgressLoad" style=" width : {{item.loadedTime}}%"></span>
                  </div>
                </template>

              </div>
            </template>
            <template lyte-else>
              <span class="lyteVideoProgressed" style="width: {{elapsedTime}}%;" ></span>
              <span class="lyteVideoProgressLoad" style=" width : {{loadedTime}}%"></span>
            </template>

            <span class="lyteVideoProgressHandler"  ontouchstart="{{action('progressMouseDown',event)}}" onmousedown="{{action('progressMouseDown',event)}}" style="left: 0;"></span>
          </div>
          <div class="lyteVideoTimer">
            <time class="duration">{{currentDuration}}</time>
            <span class="lyteVideoTimerSeparator">/</span>
            <time>{{duration}}</time>
          </div>
        </div>

        <div class="lyteVideoIconsWrap">
          <div lyte-if="{{ltPropOptions.play != false}}" class="lyteVideoPlayPauseIconWrap">
            <span class="lyteVideoIcons lyteVideoPlayIcon lyteVideoPaused" lt-prop-title="{{videoStatus}}" onclick="{{action('togglePlayPause',this)}}"></span>
          </div>
          <div lyte-if="{{ltPropOptions.backward != false}}" class="lyteVideoRewind">
            <span class="lyteVideoIcons lyteVideoRewindIcon {{backwardStatus}}" lt-prop-title={{lyteUiI18n("lyte.video.skip.backward")}} onclick="{{action('skipVideo','rewind')}}"></span>
          </div>
          <div lyte-if="{{ltPropOptions.forward != false}}" class="lyteVideoForward">
            <span class="lyteVideoIcons lyteVideoForwardIcon {{forwardStatus}}" lt-prop-title={{lyteUiI18n("lyte.video.skip.forward")}} onclick="{{action('skipVideo','forward')}}"></span>
          </div>
          <div lyte-if="{{ltPropOptions.volume != false}}" class="lyteVideoVolumeControls">
            <span class="lyteVideoVolumeIcon" lt-prop-title="{{volumeStatus}}" onclick="{{action('mute',this)}}"></span>
            <div class="lyteVideoVolumeSlider">
              <lyte-multislider lt-prop-css-direction="ltr" lt-prop-max='1' lt-prop-yield=true lt-prop-handler='lyteCircle' lt-prop-value='[ { "value" : {{volume}}, "min" : 0, "max" : 1 } ]' on-change="{{method('setVolume')}}"></lyte-multislider>
            </div>
          </div>
          <div class="lyteVideoRightIcons">
            <div lyte-if="{{ltPropOptions.settings != false}}" class="lyteVideoSettings">
              <span class="lyteVideoIcons lyteVideoSettingsIcon" lt-prop-title={{lyteUiI18n("lyte.video.settings")}} onclick="{{action('toggleSettings',event)}}"></span>
            </div>
            <div lyte-if="{{ltPropMiniMode}}" class="lyteVideoPip">
              <span class="lyteVideoIcons lyteVideoPipIcon" lt-prop-title={{lyteUiI18n("lyte.video.mode.miniMode")}} onclick="{{action('toggleMiniMode')}}"></span>
            </div>
            <template lyte-if="{{isNotFirefox}}">
              <div lyte-if="{{ltPropOptions.pip != false}}" class="lyteVideoPip">
                <span class="lyteVideoIcons lyteVideoPipIcon" lt-prop-title={{lyteUiI18n("lyte.video.mode.pip")}} onclick="{{action('togglePip')}}"></span>
              </div>
            </template>

            <div lyte-if="{{ltPropOptions.fullScreen != false}}" class="lyteVideoFullScreenControl">
              <span class="lyteVideoIcons lyteVideoFullScreen" lt-prop-title={{lyteUiI18n("lyte.video.mode.fullScreen")}} onclick="{{action('toggleFullScreen',this)}}"></span>
            </div>
          </div>

        </div>
      </div>

    </template>


    <div lyte-if="{{ltPropOptions.settings != false}}" class="lyteVideoSettingsWrapper lyteVideoSettingsItemHover  lyteVideoMenuHide" onmouseover="{{action('mouseOver')}}">
      <template lyte-if="{{subMenuOpened}}">
        <div data-value="back" class="lyteVideoSettingsDropdownHead" onclick="{{action('settingsMenuClick',this)}}">
          <div class="lyteVideoSettingsBackIcon"></div>
          <span class="lyteVideoSettingsLabel">{{lyteUiI18n(lyteUiConcat('lyte.video.menu.',selectedOption))}}</span>
        </div>
      </template>


      <template lyte-switch="{{selectedOption}}"><template lyte-case=playBackSpeed lyte-break><template lyte-for="{{speedData}} as item index ">
            <div data-value={{item.label}} class="lyteVideoSettingDropItem lyteVideoPl-40 {{lyteUiSetSelectedClass(item.label, ltPropPlayRate)}}" onclick="{{action('settingsMenuClick',this)}}">
              <span class="lyteVideoSettingsLabel">{{item.label}} </span>
            </div>
          </template>
        </template>
        <template lyte-case=qualityOption lyte-break>
          <div data-value="auto" class="lyteVideoSettingDropItem lyteVideoPl-40 {{lyteUiSetSelectedClass('auto', ltPropQuality)}}" onclick="{{action('settingsMenuClick',this)}}">
            <span class="lyteVideoSettingsLabel">{{lyteUiI18n("lyte.video.menu.qualityOption.auto")}}</span>
          </div>
          <template lyte-for="{{ltPropSource}} as item index ">
            <div data-value={{item.size}} class="lyteVideoSettingDropItem lyteVideoPl-40 {{lyteUiSetSelectedClass(item.size, ltPropQuality)}}" onclick="{{action('settingsMenuClick',this)}}">
              <span class="lyteVideoSettingsLabel">{{item.size}} </span>
            </div>
          </template>
        </template>
        <template lyte-case=subtitles lyte-break>
          <div data-value="off" class="lyteVideoSettingDropItem lyteVideoPl-40 {{lyteUiSetSelectedClass('off', ltPropCaption)}}" onclick="{{action('settingsMenuClick',this)}}">
            <span class="lyteVideoSettingsLabel">{{lyteUiI18n("lyte.video.menu.subtitles.off")}}</span>
          </div>
          <template lyte-for="{{ltPropTracks}} as item index ">
            <div data-value={{item.label}} class="lyteVideoSettingDropItem lyteVideoPl-40 {{lyteUiSetSelectedClass(item.label, ltPropCaption)}}" onclick="{{action('settingsMenuClick',this)}}">
              <span class="lyteVideoSettingsLabel">{{item.label}} </span>
            </div>
          </template>
        </template>
        <template lyte-default>
          <div data-value="subtitles" class="lyteVideoSettingsItem " onclick="{{action('settingsMenuClick',this)}}">
            <span class="lyteVideoSettingsLabel">{{lyteUiI18n("lyte.video.menu.subtitles")}} </span>
            <span class="lyteVideoSettingsKey">{{lyteUiI18n(lyteUiConcat('lyte.video.menu.subtitles.',ltPropCaption))}}</span>
          </div>
          <div data-value="playBackSpeed" class="lyteVideoSettingsItem" onclick="{{action('settingsMenuClick',this)}}">
            <span class="lyteVideoSettingsLabel">{{lyteUiI18n("lyte.video.menu.playBackSpeed")}} </span>
            <span class="lyteVideoSettingsKey">{{ltPropPlayRate}}</span>
          </div>
          <div data-value="qualityOption" class="lyteVideoSettingsItem" onclick="{{action('settingsMenuClick',this)}}">
            <span class="lyteVideoSettingsLabel">{{lyteUiI18n("lyte.video.menu.qualityOption")}} </span>
            <span class="lyteVideoSettingsKey">{{lyteUiI18n(lyteUiConcat('lyte.video.menu.qualityOption.',ltPropQuality))}}</span>
          </div>
        </template>
      </template>

    </div>
  </div>
</template>