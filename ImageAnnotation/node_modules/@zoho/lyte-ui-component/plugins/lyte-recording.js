
if($L)
{
  $L.Recording = {};
  window.afterStart = undefined;
  window.content = [];
  window.resolveFunc = undefined;
  $L.Recording.start = function(recordingObj)
  {
    var device = window.navigator.mediaDevices.getUserMedia(recordingObj);
    device.then( function(stream)  
    {
      var recorder = new window.MediaRecorder(stream,recordingObj.options);
      recorder.ondataavailable = function(e)
      {  
        content.push(e.data);
       
        recordingObj.onDataAvailable(e.data);
        
        
       }
       recorder.onstop = function(e)
       {  resolveFunc(content);
         content =[];
       }
       afterStart = recorder;
       recorder.start(recordingObj.timeSlice);
      })
   }


  $L.Recording.stop = function()
  {
   
    return(new Promise(function (resolve)
    {  afterStart.stop();
      resolveFunc = resolve;
    })); 
  }
}


